---
# TODO uncomment most of these for a full installation
- hosts: all
  tasks:
    - name: ensure my locale is present
    - locale_gen: name=en_US.UTF-8 state=present

    - name: install system packages
      become: yes
      apt: name={{ item }}
      with_items:
        # (dependencies)
        - ansible
        - git
        - make

        # Basic env
        - tmux
        - zsh
        - vim-gtk
        - python
        - python-pip

        # Dotfiles dependency
        - stow

        # Tools
        - curl
        - tree
        - xsel

    - name: install python packages
      pip: name={{ item }}
      with_items:
        - ipython

    - name: make zsh the default shell
      become: yes
      user: name="{{ ansible_user_id }}" shell=/usr/bin/zsh

    - name: clean up ~
      file: path={{ item }} state=absent
      with_items:
        - ~/.bash_profile
        - ~/.bash_logout
        - ~/.bashrc
        - ~/.profile

    # TODO modify dest
    - name: pull repo elmisback/dotfiles
      git: repo=git@github.com:elmisback/dotfiles dest=~/dotfiles accept_hostkey=yes update=no

    - name: install configuration
      command: /usr/bin/zsh install.zsh chdir=~/dotfiles creates=~/.zshenv

    #- name: clone fasd
    #  git: repo=https://github.com/clvv/fasd.git dest=/home/vagrant/lib/fasd

    #- name: build fasd
    #  become: yes
    #  command: make install chdir=/home/vagrant/lib/fasd creates=/usr/local/bin/fasd
